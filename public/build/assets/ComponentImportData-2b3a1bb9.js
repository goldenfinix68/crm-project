import{r as o,aB as _,aP as K,K as W,J as e,M as C,a2 as f,bY as b,bj as u,$ as l,W as S,Z as p,N as g,a4 as Y,af as k,a8 as q,A as z,ej as J}from"./app-36fe48bb.js";import{P as Q}from"./papaparse.min-0c34ad85.js";import{g as Z}from"./useContactMutation-2b8d3b2d.js";import{U as $}from"./index-9b34c212.js";import{C as G}from"./CheckCircleOutlined-096e46fa.js";import{U as H}from"./UploadOutlined-de38aee7.js";import"./Upload-bbdd4971.js";import"./DeleteOutlined-cb3dd239.js";const re=()=>{o.useEffect(()=>(document.title="Import Data - SpeedLead",()=>{}),[]);const E=_(),{data:s}=K("contact"),[x,N]=o.useState(!1),[r,w]=o.useState(null),[y,L]=o.useState([]),[T,M]=o.useState([]),[c,D]=o.useState({}),n=s==null?void 0:s.filter(t=>t.isRequired&&!["contactLookup","userLookup","contactTypeLookup"].includes(t.type)),[O,d]=o.useState(!1),[j,I]=o.useState(),h=W(Z,{onSuccess:t=>{d(!0),I(t.result)}}),V=e.createElement("div",null,x?e.createElement(J,null):e.createElement(H,null),e.createElement("div",{style:{marginTop:8}},"Drag and drop or choose a file We support .csv, .xls, and .xlsx files.")),U=t=>{w(t)},B=()=>{if(r){N(!0);const t=r;Q.parse(t,{header:!0,complete:function(a){const i=a.data[0];L(a.data),M(Object.entries(i)),console.log(a.data)},error:function(a){console.error("CSV parsing error:",a.message)}})}},P=n==null?void 0:n.every(t=>Object.values(c).some(a=>a==t.id)),F=()=>{P?h.mutate({csvData:y,columnMappings:c}):(console.log(n),k.error((n==null?void 0:n.map(t=>t.label).join(", "))+" required."))},A=(t,a)=>{D({...c,[t]:a})},v=Object.values(c).filter((t,a,i)=>i.indexOf(t)!==a).length>0;return console.log(n),console.log(c),e.createElement(e.Fragment,null,y.length?e.createElement(C,{direction:"vertical",className:"w-100"},e.createElement(f,{title:"Map columns from sheet to Speedlead fields "},v&&e.createElement(b,{description:"Same field selected for mapping.",type:"error"}),e.createElement(b,{description:"Mobile number must be unique for each contact, and duplicates will be ignored.",type:"warning"}),e.createElement(u,{dataSource:T,pagination:!1},e.createElement(u.Column,{title:"File Columns",key:"column1",render:([t,a])=>e.createElement(C,{direction:"vertical"},e.createElement(l.Text,null,t),e.createElement(l.Text,{style:{fontSize:"9px"}},String(a)))}),e.createElement(u.Column,{title:"Speedlead Fields",key:"column2",render:([t,a])=>{var i;return e.createElement(S,{showSearch:!0,className:"w-100",value:c[t]??"",onChange:m=>{A(t,m)},allowClear:!0,optionFilterProp:"children"},(i=s==null?void 0:s.filter(m=>!["contactLookup","userLookup","contactTypeLookup"].includes(m.type)))==null?void 0:i.map((m,R)=>e.createElement(S.Option,{value:m.id,key:R},m.label)))}})),e.createElement(p,{className:"m-t-xl"},e.createElement(g,{type:"primary",onClick:F,disabled:!r||v,loading:h.isLoading},"Import")))):e.createElement(f,null,e.createElement(l.Title,{level:3},"Import using file"),e.createElement(l,{className:"m-b-sm"},"You can import contacts, companies, deals, activities, and notes separately or using a single file by grouping records together."),e.createElement(l.Link,{href:"",target:"_blank"},"Learn more about how to import using an individual or grouped file."),e.createElement(Y,null),e.createElement(p,{style:{display:"flex",justifyContent:"center"}},e.createElement(l.Title,{level:5},"Need help in getting started?")),e.createElement(p,{style:{display:"flex",justifyContent:"center"}},e.createElement(l.Link,{href:"/files/importsamplefile.csv",target:"_blank"},"Download sample spreadsheet"),e.createElement(l,{className:"m-r-sm m-l-sm"},"|"),e.createElement(l.Link,{href:"",target:"_blank"},"View import FAQs")),e.createElement(p,null,e.createElement($,{name:"file",listType:"picture-card",className:"avatar-uploader upload m-t-lg",showUploadList:!1,beforeUpload:t=>["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"].includes(t.type)?(U(t),!1):(k.error("Only CSV or Excel files are allowed!"),!1)},r?e.createElement("div",null,r.name):V)),e.createElement(p,{className:"m-t-xl"},e.createElement(g,{type:"primary",onClick:B,disabled:!r},"Next"))),e.createElement(q,{className:"modal-activity",open:O,onCancel:()=>{E("/contacts"),d(!1)},footer:null,title:null,closable:!1,width:"500px"},e.createElement("div",{className:"modal-header"},e.createElement(l.Title,{level:5,style:{color:"white"}},"Import Success"),e.createElement(g,{onClick:()=>{E("/contacts"),d(!1)},style:{backgroundColor:"rgba(0, 0, 0, 0.5)",border:"0px"},icon:e.createElement(z,{style:{color:"white"}})})),e.createElement(f,{className:"p-t-md"},e.createElement(u,{dataSource:j,pagination:!1},e.createElement(u.Column,{title:"Contact Name",dataIndex:"contactName",key:"contactName"}),e.createElement(u.Column,{title:"Success",key:"deal",render:(t,a)=>e.createElement(G,{style:{color:"green"}})})))))};export{re as default};
