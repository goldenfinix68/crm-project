import{O as g,P as k,J as e,M as E,a2 as Y,bk as f,a5 as p}from"./app-9bf2aa21.js";import{H as y}from"./HeaderMenu-466bbe59.js";import{T as a}from"./TextEllipsis-3335aeb2.js";import{B as l}from"./index-ddfae42f.js";const x=()=>{const{data:c,isLoading:m,isError:o}=g("workflows",async()=>{const d=localStorage.getItem("access_token");return(await k.get("/api/workflows",{headers:{Authorization:`Bearer ${d}`}})).data},{staleTime:1/0});return{workflows:c,isLoading:m,isError:o}},_=()=>{const{workflows:c}=x(),m=s=>{console.log(s);const r=[{title:"Trigger At",key:"trigger_at",render:(t,n)=>{const u=p.utc(n.trigger_at,"YYYY-MM-DD HH:mm:ss").clone().local();return e.createElement("div",{className:"p-xs"},e.createElement(a,null,u.format("MMM DD, YYYY hh:mm A")))}},{title:"Status",key:"queue_lock",render:t=>{if(t.success+t.failed==t.total)return e.createElement(l,{status:"success",text:"Completed"});if(t.success||t.failed)return e.createElement(l,{status:"processing",text:"In Progress"});if(t.queue_lock){if(t.queue_lock)return e.createElement(l,{status:"processing",text:"Queued"})}else return e.createElement(l,{status:"default",text:"Pending"})}},{title:"Success",key:"success",render:t=>e.createElement(a,{style:{color:"green"}},t.success)},{title:"Failed",key:"failed",render:t=>e.createElement(a,{style:{color:"red"}},t.failed)},{title:"Total",key:"contactIds",render:t=>{const n=JSON.parse(t.contactIds);return e.createElement(a,null,n.length)}}];return e.createElement(f,{columns:r,dataSource:s.items,pagination:!1})},o=s=>{const r=s.items,t=r.reduce((i,u)=>i+u.success,0),n=r.reduce((i,u)=>i+u.failed,0);return t+n==s.total?"completed":t||n?"inProgress":"pending"},d=[{title:"Name",dataIndex:"action",key:"action"},{title:"Bulk Operation (Type)",key:"operation",render:()=>e.createElement("div",{className:"p-xs"},e.createElement(a,null,"Bulk Workflow"))},{title:"Status",key:"status",render:s=>o(s)=="completed"?e.createElement(l,{status:"success",text:"Completed"}):o(s)=="inProgress"?e.createElement(l,{status:"processing",text:"In Progress"}):e.createElement(l,{status:"default",text:"Pending"})},{title:"Created",key:"created_at",render:s=>e.createElement(a,null,p(s).format("MMM D, YYYY"))},{title:"User",key:"user",render:(s,r)=>{var t,n;return e.createElement(a,null,`${(t=r.user)==null?void 0:t.firstName} ${(n=r.user)==null?void 0:n.lastName}`)}},{title:"Completed (Date and Time)",key:"completedAt",render:s=>{const r=p(s.completedAt,"YYYY-MM-DD HH:mm:ss");return o(s)=="completed"?e.createElement(a,null,r.format("MMM DD, YYYY hh:mm A")):null}}];return e.createElement(E,{direction:"vertical",className:"w-100"},e.createElement(y,null),e.createElement(Y,null,e.createElement(f,{columns:d,expandable:{expandedRowRender:m},dataSource:c==null?void 0:c.map((s,r)=>({...s,key:r}))})))};export{_ as default};
