import{r as i,au as b,av as T,ak as S,aw as C,K as N,J as t,a2 as h,M as E,ap as v,N as x,aa as f,W as m,ax as k}from"./app-eba8fa48.js";import{T as y}from"./TextEllipsis-e37009b4.js";const A=({})=>{i.useEffect(()=>(document.title="Call Forwarding - SpeedLead",()=>{}),[]),b();const{users:n,isLoading:c}=T(),{loggedInUser:s}=S(),{array:o,updateById:d,setInitialArray:w}=C();i.useState((s==null?void 0:s.forwardingType)??"off");const u=N(k,{onSuccess:()=>{f.success("Succesfully saved.")},onError:r=>{console.log(r.message||"An error occurred")}}),p=r=>{console.log(r);for(const e of r.users)if(e.forwardingType!=="off"&&!e.forwardTo)return f.error("Forward to is required if forward type is not set to do not forward."),!1;u.mutate(r)},g=[{key:"Name",title:"Name",render:(r,e)=>t.createElement(y,{style:{paddingLeft:"8px"}},`${e.firstName} ${e.lastName}`)},{key:"telnyxConnectionName",title:"SIP Trunking / Mobile Numbers",render:(r,e)=>{var a;return t.createElement(y,{style:{paddingLeft:"8px"}},e.telnyxConnectionName?`${e.telnyxConnectionName} (${(a=e.numbers)!=null&&a.length?e.numbers.map(l=>l.mobileNumber).join(", "):""})`:"Not Set")}},{key:"type",title:"Forward Type",render:(r,e)=>t.createElement(m,{style:{width:"80%"},showSearch:!0,options:[{value:"off",label:"Do not forward"},{value:"on-failure",label:"Forward on failure"},{value:"always",label:"Forward always"}],value:e.forwardingType,onChange:a=>{d(e.id,{...e,forwardingType:a,forwardTo:a=="off"?"":e.forwardTo})}})},{key:"forwardTo",title:"Forward To",render:(r,e)=>t.createElement(m,{style:{width:"80%"},showSearch:!0,options:o==null?void 0:o.filter(a=>a.id!=e.id).map(a=>{var l;return{label:`${a.firstName} ${a.lastName}`,value:(l=a.id)==null?void 0:l.toString()}}),disabled:e.forwardingType=="off",value:e.forwardTo,onChange:a=>{d(e.id,{...e,forwardTo:a})}})}];return i.useEffect(()=>{w(n==null?void 0:n.filter(r=>r.numbers.length))},[n]),t.createElement(h,{style:{boxShadow:"none"},bodyStyle:{padding:"19px"},bordered:!1,loading:c},t.createElement(E,{direction:"vertical",className:"w-100",size:"large"},t.createElement(v,{columns:g,dataSource:o,pagination:!1,localStorageKey:"callForwardingTableColumnsWidth"}),t.createElement(x,{type:"primary",onClick:()=>{p({users:o})},loading:u.isLoading,style:{float:"right"}},"Save")))};export{A as default};
