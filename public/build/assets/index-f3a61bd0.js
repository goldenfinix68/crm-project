import{r as o,C as V,bE as se,c as X,bF as Te,bz as Oe,g as ve,m as Se,b as we,bG as Ie,t as ae,e as je,I as C,bH as oe,K as _,L as $,J as t,al as W,a8 as ie,$ as N,N as E,A as ce,M as x,Z as U,Y as A,V as q,W as re,a_ as ke,a$ as Ae,af as Ne,ai as J,aC as K,bI as Pe,ak as B,bk as Me,a5 as _e,aA as $e,az as Be,bJ as Fe,U as De,a2 as Re,aB as ze,aZ as S,bu as Y,a6 as Le,a7 as He}from"./app-9c9e7353.js";import{C as de}from"./ConfirmModal-80b94226.js";import{D as Xe}from"./DeleteOutlined-2e5c1a7b.js";const me=e=>{let{children:r}=e;const{getPrefixCls:a}=o.useContext(V),n=a("breadcrumb");return o.createElement("li",{className:`${n}-separator`,"aria-hidden":"true"},r===""?r:r||"/")};me.__ANT_BREADCRUMB_SEPARATOR=!0;const G=me;var Ue=globalThis&&globalThis.__rest||function(e,r){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)r.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]]);return a};function qe(e,r){if(e.title===void 0||e.title===null)return null;const a=Object.keys(r).join("|");return typeof e.title=="object"?e.title:String(e.title).replace(new RegExp(`:(${a})`,"g"),(n,l)=>r[l]||n)}function ue(e,r,a,n){if(a==null)return null;const{className:l,onClick:s}=r,i=Ue(r,["className","onClick"]),c=Object.assign(Object.assign({},se(i,{data:!0,aria:!0})),{onClick:s});return n!==void 0?o.createElement("a",Object.assign({},c,{className:X(`${e}-link`,l),href:n}),a):o.createElement("span",Object.assign({},c,{className:X(`${e}-link`,l)}),a)}function Ye(e,r){return(n,l,s,i,c)=>{if(r)return r(n,l,s,i);const m=qe(n,l);return ue(e,n,m,c)}}var Q=globalThis&&globalThis.__rest||function(e,r){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)r.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]]);return a};const pe=e=>{const{prefixCls:r,separator:a="/",children:n,menu:l,overlay:s,dropdownProps:i,href:c}=e,u=(g=>{if(l||s){const f=Object.assign({},i);if(l){const p=l||{},{items:y}=p,h=Q(p,["items"]);f.menu=Object.assign(Object.assign({},h),{items:y==null?void 0:y.map((d,b)=>{var{key:T,title:w,label:O,path:P}=d,F=Q(d,["key","title","label","path"]);let j=O??w;return P&&(j=o.createElement("a",{href:`${c}${P}`},j)),Object.assign(Object.assign({},F),{key:T??b,label:j})})})}else s&&(f.overlay=s);return o.createElement(Te,Object.assign({placement:"bottom"},f),o.createElement("span",{className:`${r}-overlay-link`},g,o.createElement(Oe,null)))}return g})(n);return u!=null?o.createElement(o.Fragment,null,o.createElement("li",null,u),a&&o.createElement(G,null,a)):null},ge=e=>{const{prefixCls:r,children:a,href:n}=e,l=Q(e,["prefixCls","children","href"]),{getPrefixCls:s}=o.useContext(V),i=s("breadcrumb",r);return o.createElement(pe,Object.assign({},l,{prefixCls:i}),ue(i,l,a,n))};ge.__ANT_BREADCRUMB_ITEM=!0;const Qe=ge,Ve=e=>{const{componentCls:r,iconCls:a}=e;return{[r]:Object.assign(Object.assign({},we(e)),{color:e.itemColor,fontSize:e.fontSize,[a]:{fontSize:e.iconFontSize},ol:{display:"flex",flexWrap:"wrap",margin:0,padding:0,listStyle:"none"},a:Object.assign({color:e.linkColor,transition:`color ${e.motionDurationMid}`,padding:`0 ${e.paddingXXS}px`,borderRadius:e.borderRadiusSM,height:e.lineHeight*e.fontSize,display:"inline-block",marginInline:-e.marginXXS,"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover}},Ie(e)),"li:last-child":{color:e.lastItemColor},[`${r}-separator`]:{marginInline:e.separatorMargin,color:e.separatorColor},[`${r}-link`]:{[`
          > ${a} + span,
          > ${a} + a
        `]:{marginInlineStart:e.marginXXS}},[`${r}-overlay-link`]:{borderRadius:e.borderRadiusSM,height:e.lineHeight*e.fontSize,display:"inline-block",padding:`0 ${e.paddingXXS}px`,marginInline:-e.marginXXS,[`> ${a}`]:{marginInlineStart:e.marginXXS,fontSize:e.fontSizeIcon},"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover,a:{color:e.linkHoverColor}},a:{"&:hover":{backgroundColor:"transparent"}}},[`&${e.componentCls}-rtl`]:{direction:"rtl"}})}},We=ve("Breadcrumb",e=>{const r=Se(e,{});return[Ve(r)]},e=>({itemColor:e.colorTextDescription,lastItemColor:e.colorText,iconFontSize:e.fontSize,linkColor:e.colorTextDescription,linkHoverColor:e.colorText,separatorColor:e.colorTextDescription,separatorMargin:e.marginXS}));var le=globalThis&&globalThis.__rest||function(e,r){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)r.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]]);return a};function Je(e){const{breadcrumbName:r,children:a}=e,n=le(e,["breadcrumbName","children"]),l=Object.assign({title:r},n);return a&&(l.menu={items:a.map(s=>{var{breadcrumbName:i}=s,c=le(s,["breadcrumbName"]);return Object.assign(Object.assign({},c),{title:i})})}),l}function Ke(e,r){return o.useMemo(()=>e||(r?r.map(Je):null),[e,r])}var Ge=globalThis&&globalThis.__rest||function(e,r){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)r.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]]);return a};const Ze=(e,r)=>{if(r===void 0)return r;let a=(r||"").replace(/^\//,"");return Object.keys(e).forEach(n=>{a=a.replace(`:${n}`,e[n])}),a},Z=e=>{const{prefixCls:r,separator:a="/",style:n,className:l,rootClassName:s,routes:i,items:c,children:m,itemRender:u,params:g={}}=e,f=Ge(e,["prefixCls","separator","style","className","rootClassName","routes","items","children","itemRender","params"]),{getPrefixCls:p,direction:y,breadcrumb:h}=o.useContext(V);let d;const b=p("breadcrumb",r),[T,w]=We(b),O=Ke(c,i),P=Ye(b,u);if(O&&O.length>0){const I=[],k=c||i;d=O.map((v,M)=>{const{path:fe,key:D,type:ye,menu:ee,overlay:te,onClick:be,className:Ee,separator:he,dropdownProps:Ce}=v,R=Ze(g,fe);R!==void 0&&I.push(R);const ne=D??M;if(ye==="separator")return o.createElement(G,{key:ne},he);const z={},xe=M===O.length-1;ee?z.menu=ee:te&&(z.overlay=te);let{href:L}=v;return I.length&&R!==void 0&&(L=`#/${I.join("/")}`),o.createElement(pe,Object.assign({key:ne},z,se(v,{data:!0,aria:!0}),{className:Ee,dropdownProps:Ce,href:L,separator:xe?"":a,onClick:be,prefixCls:b}),P(v,g,k,I,L))})}else if(m){const I=ae(m).length;d=ae(m).map((k,v)=>{if(!k)return k;const M=v===I-1;return je(k,{separator:M?"":a,key:v})})}const F=X(b,h==null?void 0:h.className,{[`${b}-rtl`]:y==="rtl"},l,s,w),j=Object.assign(Object.assign({},h==null?void 0:h.style),n);return T(o.createElement("nav",Object.assign({className:F,style:j},f),o.createElement("ol",null,d)))};Z.Item=Qe;Z.Separator=G;const H=Z,et=async e=>{const r=localStorage.getItem("access_token"),a=await fetch("/api/text-template-folders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(e)}),n=await a.json();if(!a.ok)throw new Error(n.message||"Failed to add contact type");return n},tt=async e=>{const r=localStorage.getItem("access_token"),a=await fetch("/api/text-templates/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}}),n=await a.json();if(!a.ok)throw new Error(n.message||"Failed to add contact type");return n},nt=async e=>{const r=localStorage.getItem("access_token"),a=await fetch("/api/text-template-folders/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}}),n=await a.json();if(!a.ok)throw new Error(n.message||"Failed to add contact type");return n},at=async e=>{const r=localStorage.getItem("access_token"),a=await fetch("/api/text-templates",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(e)}),n=await a.json();if(!a.ok)throw new Error(n.message||"Failed to add contact type");return n},rt=({template:e,isModalOpen:r,handleClose:a})=>{const[n,l]=o.useState(!1),[s]=C.useForm(),{folders:i,isLoading:c}=oe(),m=C.useWatch("textMessage",s),u=_(at,{onSuccess:()=>{$.invalidateQueries("textTemplates"),f()},onError:p=>{console.log(p.message||"An error occurred")}}),g=async p=>{await u.mutate({...p,id:e!=null&&e.id?e.id:""})},f=()=>{a(),s.resetFields()};return o.useEffect(()=>{e!=null&&e.name?s.setFieldsValue(e):s.resetFields()},[e]),c?t.createElement(W,null):t.createElement(t.Fragment,null,t.createElement(ie,{className:"modal-activity",open:r,onCancel:f,footer:null,title:null,closable:!1},t.createElement("div",{className:"modal-header"},t.createElement(N.Title,{level:5,style:{color:"white"}},e?"Update":"Create new"," Template"),t.createElement(E,{onClick:f,style:{backgroundColor:"rgba(0, 0, 0, 0.5)",border:"0px"},icon:t.createElement(ce,{style:{color:"white"}})})),t.createElement(x,{direction:"vertical",style:{padding:"20px",width:"100%",paddingTop:"30px"},size:0},t.createElement(C,{name:"basic",layout:"vertical",labelWrap:!0,onFinish:g,autoComplete:"off",form:s},t.createElement(U,{gutter:12},t.createElement(A,{span:12},t.createElement(C.Item,{label:"Template name",name:"name",rules:[{required:!0,message:"this is required"}]},t.createElement(q,null))),t.createElement(A,{span:12},t.createElement(C.Item,{label:"Folder",name:"folderId",rules:[{required:!0,message:"this is required"}]},t.createElement(re,{style:{width:"100%"}},i==null?void 0:i.map((p,y)=>t.createElement(re.Option,{value:p.id,key:p.id},p.name)))))),t.createElement(C.Item,{label:"Text message",name:"textMessage",rules:[{required:!0,message:"this is required"}]},t.createElement(q.TextArea,{rows:4,placeholder:"Type here ..."})),t.createElement(x,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginTop:"-20px",marginBottom:"20px"}},t.createElement(N.Text,null,"Count: ",(m==null?void 0:m.length)??0),t.createElement(ke,{content:t.createElement(Ae,{handleSelect:p=>{const y=s.getFieldValue("textMessage");s.setFieldValue("textMessage",`${y??""}{{${p.fieldName}}}`),l(!1)}}),title:t.createElement(E,{type:"link",style:{padding:0},onClick:()=>l(!1)},"Cancel"),trigger:"click",open:n},t.createElement(E,{type:"link",onClick:()=>l(!0)},"Insert Attribute ",t.createElement(Ne,null)))),t.createElement(x,{style:{paddingTop:"5px"}},t.createElement(E,{type:"primary",htmlType:"submit",loading:u.isLoading},"Save"),t.createElement(E,{onClick:f},"Cancel"))))))},lt=({handleEditBtnClicked:e})=>{const{route:r}=J(),a=r??"All";K();const{templates:n,isLoading:l}=Pe(),[s,i]=o.useState(),[c,m]=o.useState(!1),[u,g]=o.useState(!1),{isRoleStats:f}=B(),p=_(d=>tt(d),{onSuccess:()=>{$.invalidateQueries("textTemplates"),m(!1)},onError:d=>{console.log(d.message||"An error occurred")}}),y=[{title:"Name",dataIndex:"name",key:"name",render:d=>t.createElement("p",{className:"p-l-md"},d)},{title:"Created By",key:"created_at",render:(d,b)=>{var T,w;return((T=b.user)==null?void 0:T.firstName)+" "+((w=b.user)==null?void 0:w.lastName)}},{title:"Sent",dataIndex:"sent",render:d=>""},{title:"Created",key:"created_at",render:d=>_e(d).format("MMM D, YYYY")},{title:"Action",key:"action",render:(d,b)=>t.createElement(x,{size:"middle"},t.createElement(E,{type:"link",style:{padding:"0"},onClick:()=>e(b),disabled:f},t.createElement($e,null)),t.createElement(E,{type:"link",style:{padding:"0"},onClick:()=>{i(b),m(!0)},disabled:f},t.createElement(Xe,null)))}],h=()=>a=="Archived"?n==null?void 0:n.filter(d=>d.deleted_at):a!="All"?n==null?void 0:n.filter(d=>{var b;return!d.deleted_at&&((b=d.folder)==null?void 0:b.name)==a}):n==null?void 0:n.filter(d=>!d.deleted_at);return l?t.createElement(W,null):t.createElement(t.Fragment,null,t.createElement(Me,{columns:y,dataSource:h()}),t.createElement(de,{title:"Confirm",message:`Are you sure you want to delete ${s==null?void 0:s.name}?`,handleNo:()=>m(!1),handleYes:async()=>{g(!0),await p.mutate(s.id),g(!1)},isOpen:c,loading:u}))},st=({folders:e})=>{const{route:r}=J(),a=r??"All";K();const[n,l]=o.useState(!1),[s,i]=o.useState(),c=()=>{l(!0)},m=()=>{l(!1),i(void 0)},u=g=>{i(g),c()};return t.createElement(x,{direction:"vertical",style:{width:"100%"}},t.createElement(ot,{folder:a,handleAdd:c}),t.createElement("div",{style:{padding:"20px"}},t.createElement(lt,{handleEditBtnClicked:u})),t.createElement(rt,{handleClose:m,isModalOpen:n,template:s}))},ot=({folder:e,handleAdd:r})=>{const{isRoleStats:a}=B();return t.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"white"}},t.createElement("div",{style:{flexGrow:1}},t.createElement(H,{style:{fontSize:"20px"}},t.createElement(H.Item,null,t.createElement(Be,{to:"/text-threads"},"Text Threads")),t.createElement(H.Item,null,e))),t.createElement("div",{style:{marginLeft:"16px"}},t.createElement(E,{type:"primary",icon:t.createElement(Fe,null),onClick:r,disabled:a},"Add Template")))},it=({isModalOpen:e,closeModal:r,templateFolder:a})=>{const[n]=C.useForm(),l=_(et,{onSuccess:()=>{$.invalidateQueries("textTemplates"),r(),i()},onError:c=>{console.log(c.message||"An error occurred")}}),s=async c=>{await l.mutate({...c,id:a!=null&&a.id?a.id:""})},i=()=>{r(),n.resetFields()};return o.useEffect(()=>{a!=null&&a.name?n.setFieldValue("name",a.name):n.resetFields()},[a]),t.createElement(ie,{className:"modal-activity",open:e,onCancel:r,footer:null,title:null,closable:!1},t.createElement("div",{className:"modal-header"},t.createElement(N.Title,{level:5,style:{color:"white"}},a?"Update":"Create new"," folder"),t.createElement(E,{onClick:r,style:{backgroundColor:"rgba(0, 0, 0, 0.5)",border:"0px"},icon:t.createElement(ce,{style:{color:"white"}})})),t.createElement(x,{direction:"vertical",style:{padding:"20px",width:"100%",paddingTop:"30px"},size:0},t.createElement(C,{name:"basic",layout:"vertical",labelWrap:!0,onFinish:s,autoComplete:"off",form:n},t.createElement(C.Item,{name:"name",label:"Folder name",rules:[{required:!0,message:De}]},t.createElement(q,{placeholder:"Folder name"})),t.createElement(x,{style:{paddingTop:"5px"}},t.createElement(E,{type:"primary",htmlType:"submit",loading:l.isLoading},"Save"),t.createElement(E,{onClick:i},"Cancel")))))},pt=()=>{const{route:e}=J(),{isRoleStats:r}=B(),[a,n]=o.useState(e??"All"),[l,s]=o.useState(),{folders:i,isLoading:c}=oe(),[m,u]=o.useState(!1);return c?t.createElement(W,null):t.createElement(t.Fragment,null,t.createElement(Re,{bodyStyle:{padding:0}},t.createElement(U,{gutter:0},t.createElement(A,{span:4,style:{padding:"24px"}},t.createElement(U,null,t.createElement(A,{span:24},t.createElement(x,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t.createElement(N.Text,{strong:!0},"Folders"),t.createElement(E,{type:"link",style:{padding:0},onClick:()=>{s(void 0),u(!0)},disabled:r},t.createElement(ze,null))),t.createElement(S,{mode:"vertical",selectedKeys:[a],style:{height:"80vh"}},t.createElement(S.Item,{key:"All"},t.createElement(Y,{to:"/text-templates"},"All")),i&&(i==null?void 0:i.map(g=>t.createElement(ct,{template:g,handleRename:f=>{u(!0),s(f)}}))),t.createElement(S.Item,{key:"Archived"},t.createElement(Y,{to:"/text-templates/Archived"},"Archived")))))),t.createElement(A,{span:20,style:{backgroundColor:"#F5F5F5",margin:0,height:"85vh",overflowY:"auto"}},t.createElement(st,null)))),t.createElement(it,{isModalOpen:m,closeModal:()=>u(!1),templateFolder:l}))},ct=({template:e,handleRename:r})=>{const{isRoleStats:a}=B(),[n,l]=o.useState(!1),[s,i]=o.useState(!1),[c,m]=o.useState(!1),[u,g]=o.useState(!1);K();const f=_(y=>nt(e.id),{onSuccess:()=>{$.invalidateQueries("textTemplateFolders"),m(!1)},onError:y=>{console.log(y.message||"An error occurred")}}),p=t.createElement(S,{disabled:a},t.createElement(S.Item,{key:"rename",onClick:()=>{r(e),l(!1)}},"Rename"),t.createElement(S.Item,{key:"delete",onClick:()=>{m(!0),l(!1)}},"Delete"));return t.createElement(t.Fragment,null,t.createElement(S.Item,{key:e.name,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onClick:y=>y.preventDefault()},t.createElement(x,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},t.createElement(N.Text,null,t.createElement(Y,{to:"/text-templates/"+e.name},e.name)),n&&t.createElement(Le,{overlay:p,trigger:["click"],placement:"bottomRight",open:s},t.createElement(E,{type:"link",style:{padding:0},onClick:y=>{i(!s)}},t.createElement(He,null))))),t.createElement(de,{title:"Confirm",message:`Are you sure you want to delete ${e.name}?`,handleNo:()=>m(!1),handleYes:async()=>{g(!0),await f.mutate(e.id),g(!1)},isOpen:c,loading:u}))};export{pt as default};
