import{r as h,d1 as me,dr as ye,cZ as P,cQ as Y,cY as se,_ as x,c as ie,cA as ke,cR as ce,cS as le,cT as ue,c_ as $,cV as de,cU as T,J as H,bG as be,ez as Ce,eA as ee}from"./app-ef1c9cf0.js";var Se={percent:0,prefixCls:"rc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1,gapPosition:"bottom"},De=function(){var a=h.useRef([]),n=h.useRef(null);return h.useEffect(function(){var e=Date.now(),o=!1;a.current.forEach(function(r){if(r){o=!0;var s=r.style;s.transitionDuration=".3s, .3s, .3s, .06s",n.current&&e-n.current<100&&(s.transitionDuration="0s, 0s")}}),o&&(n.current=Date.now())}),a.current},re=0,Ee=ye();function Fe(){var t;return Ee?(t=re,re+=1):t="TEST_OR_SSR",t}const we=function(t){var a=h.useState(),n=me(a,2),e=n[0],o=n[1];return h.useEffect(function(){o("rc_progress_".concat(Fe()))},[]),t||e};var te=function(a){var n=a.bg,e=a.children;return h.createElement("div",{style:{width:"100%",height:"100%",background:n}},e)};function ae(t,a){return Object.keys(t).map(function(n){var e=parseFloat(n),o="".concat(Math.floor(e*a),"%");return"".concat(t[n]," ").concat(o)})}var Pe=h.forwardRef(function(t,a){var n=t.prefixCls,e=t.color,o=t.gradientId,r=t.radius,s=t.style,i=t.ptg,l=t.strokeLinecap,c=t.strokeWidth,u=t.size,f=t.gapDegree,p=e&&P(e)==="object",g=p?"#FFF":void 0,v=u/2,m=h.createElement("circle",{className:"".concat(n,"-circle-path"),r,cx:v,cy:v,stroke:g,strokeLinecap:l,strokeWidth:c,opacity:i===0?0:1,style:s,ref:a});if(!p)return m;var S="".concat(o,"-conic"),y=f?"".concat(180+f/2,"deg"):"0deg",k=ae(e,(360-f)/360),D=ae(e,1),E="conic-gradient(from ".concat(y,", ").concat(k.join(", "),")"),d="linear-gradient(to ".concat(f?"bottom":"top",", ").concat(D.join(", "),")");return h.createElement(h.Fragment,null,h.createElement("mask",{id:S},m),h.createElement("foreignObject",{x:0,y:0,width:u,height:u,mask:"url(#".concat(S,")")},h.createElement(te,{bg:d},h.createElement(te,{bg:E}))))}),I=100,B=function(a,n,e,o,r,s,i,l,c,u){var f=arguments.length>10&&arguments[10]!==void 0?arguments[10]:0,p=e/100*360*((360-s)/360),g=s===0?0:{bottom:0,top:180,left:90,right:-90}[i],v=(100-o)/100*n;c==="round"&&o!==100&&(v+=u/2,v>=n&&(v=n-.01));var m=I/2;return{stroke:typeof l=="string"?l:void 0,strokeDasharray:"".concat(n,"px ").concat(a),strokeDashoffset:v+f,transform:"rotate(".concat(r+p+g,"deg)"),transformOrigin:"".concat(m,"px ").concat(m,"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s",fillOpacity:0}},Re=["id","prefixCls","steps","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","style","className","strokeColor","percent"];function ne(t){var a=t??[];return Array.isArray(a)?a:[a]}var _e=function(a){var n=Y(Y({},Se),a),e=n.id,o=n.prefixCls,r=n.steps,s=n.strokeWidth,i=n.trailWidth,l=n.gapDegree,c=l===void 0?0:l,u=n.gapPosition,f=n.trailColor,p=n.strokeLinecap,g=n.style,v=n.className,m=n.strokeColor,S=n.percent,y=se(n,Re),k=I/2,D=we(e),E="".concat(D,"-gradient"),d=k-s/2,b=Math.PI*2*d,C=c>0?90+c/2:-90,F=b*((360-c)/360),q=P(r)==="object"?r:{count:r,space:2},R=q.count,G=q.space,V=ne(S),L=ne(m),J=L.find(function(O){return O&&P(O)==="object"}),pe=J&&P(J)==="object",M=pe?"butt":p,fe=B(b,F,0,100,C,c,u,f,M,s),Z=De(),ve=function(){var W=0;return V.map(function(j,w){var N=L[w]||L[L.length-1],A=B(b,F,W,j,C,c,u,N,M,s);return W+=j,h.createElement(Pe,{key:w,color:N,ptg:j,radius:d,prefixCls:o,gradientId:E,style:A,strokeLinecap:M,strokeWidth:s,gapDegree:c,ref:function(_){Z[w]=_},size:I})}).reverse()},he=function(){var W=Math.round(R*(V[0]/100)),j=100/R,w=0;return new Array(R).fill(null).map(function(N,A){var U=A<=W-1?L[0]:f,_=U&&P(U)==="object"?"url(#".concat(E,")"):void 0,Q=B(b,F,w,j,C,c,u,U,"butt",s,G);return w+=(F-Q.strokeDashoffset+G)*100/F,h.createElement("circle",{key:A,className:"".concat(o,"-circle-path"),r:d,cx:k,cy:k,stroke:_,strokeWidth:s,opacity:1,style:Q,ref:function(ge){Z[A]=ge}})})};return h.createElement("svg",x({className:ie("".concat(o,"-circle"),v),viewBox:"0 0 ".concat(I," ").concat(I),style:g,id:e,role:"presentation"},y),!R&&h.createElement("circle",{className:"".concat(o,"-circle-trail"),r:d,cx:k,cy:k,stroke:f,strokeLinecap:M,strokeWidth:i||s,style:fe}),R?he():ve())};function Le(t,a){var n="cannot ".concat(t.method," ").concat(t.action," ").concat(a.status,"'"),e=new Error(n);return e.status=a.status,e.method=t.method,e.url=t.action,e}function oe(t){var a=t.responseText||t.response;if(!a)return a;try{return JSON.parse(a)}catch{return a}}function je(t){var a=new XMLHttpRequest;t.onProgress&&a.upload&&(a.upload.onprogress=function(r){r.total>0&&(r.percent=r.loaded/r.total*100),t.onProgress(r)});var n=new FormData;t.data&&Object.keys(t.data).forEach(function(o){var r=t.data[o];if(Array.isArray(r)){r.forEach(function(s){n.append("".concat(o,"[]"),s)});return}n.append(o,r)}),t.file instanceof Blob?n.append(t.filename,t.file,t.file.name):n.append(t.filename,t.file),a.onerror=function(r){t.onError(r)},a.onload=function(){return a.status<200||a.status>=300?t.onError(Le(t,a),oe(a)):t.onSuccess(oe(a),a)},a.open(t.method,t.action,!0),t.withCredentials&&"withCredentials"in a&&(a.withCredentials=!0);var e=t.headers||{};return e["X-Requested-With"]!==null&&a.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(e).forEach(function(o){e[o]!==null&&a.setRequestHeader(o,e[o])}),a.send(n),{abort:function(){a.abort()}}}var Ae=+new Date,Ie=0;function z(){return"rc-upload-".concat(Ae,"-").concat(++Ie)}const K=function(t,a){if(t&&a){var n=Array.isArray(a)?a:a.split(","),e=t.name||"",o=t.type||"",r=o.replace(/\/.*$/,"");return n.some(function(s){var i=s.trim();if(/^\*(\/\*)?$/.test(s))return!0;if(i.charAt(0)==="."){var l=e.toLowerCase(),c=i.toLowerCase(),u=[c];return(c===".jpg"||c===".jpeg")&&(u=[".jpg",".jpeg"]),u.some(function(f){return l.endsWith(f)})}return/\/\*$/.test(i)?r===i.replace(/\/.*$/,""):o===i?!0:/^\w+$/.test(i)?(ke(!1,"Upload takes an invalidate 'accept' type '".concat(i,"'.Skip for check.")),!0):!1})}return!0};function qe(t,a){var n=t.createReader(),e=[];function o(){n.readEntries(function(r){var s=Array.prototype.slice.apply(r);e=e.concat(s);var i=!s.length;i?a(e):o()})}o()}var Me=function(a,n,e){var o=function r(s,i){s&&(s.path=i||"",s.isFile?s.file(function(l){e(l)&&(s.fullPath&&!l.webkitRelativePath&&(Object.defineProperties(l,{webkitRelativePath:{writable:!0}}),l.webkitRelativePath=s.fullPath.replace(/^\//,""),Object.defineProperties(l,{webkitRelativePath:{writable:!1}})),n([l]))}):s.isDirectory&&qe(s,function(l){l.forEach(function(c){r(c,"".concat(i).concat(s.name,"/"))})}))};a.forEach(function(r){o(r.webkitGetAsEntry())})},Oe=["component","prefixCls","className","disabled","id","style","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave"],We=function(t){ce(n,t);var a=le(n);function n(){var e;ue(this,n);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=a.call.apply(a,[this].concat(r)),e.state={uid:z()},e.reqs={},e.fileInput=void 0,e._isMounted=void 0,e.onChange=function(i){var l=e.props,c=l.accept,u=l.directory,f=i.target.files,p=$(f).filter(function(g){return!u||K(g,c)});e.uploadFiles(p),e.reset()},e.onClick=function(i){var l=e.fileInput;if(l){var c=e.props,u=c.children,f=c.onClick;if(u&&u.type==="button"){var p=l.parentNode;p.focus(),p.querySelector("button").blur()}l.click(),f&&f(i)}},e.onKeyDown=function(i){i.key==="Enter"&&e.onClick(i)},e.onFileDrop=function(i){var l=e.props.multiple;if(i.preventDefault(),i.type!=="dragover")if(e.props.directory)Me(Array.prototype.slice.call(i.dataTransfer.items),e.uploadFiles,function(u){return K(u,e.props.accept)});else{var c=$(i.dataTransfer.files).filter(function(u){return K(u,e.props.accept)});l===!1&&(c=c.slice(0,1)),e.uploadFiles(c)}},e.uploadFiles=function(i){var l=$(i),c=l.map(function(u){return u.uid=z(),e.processFile(u,l)});Promise.all(c).then(function(u){var f=e.props.onBatchStart;f==null||f(u.map(function(p){var g=p.origin,v=p.parsedFile;return{file:g,parsedFile:v}})),u.filter(function(p){return p.parsedFile!==null}).forEach(function(p){e.post(p)})})},e.processFile=function(){var i=Ce(ee().mark(function l(c,u){var f,p,g,v,m,S,y,k,D;return ee().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(f=e.props.beforeUpload,p=c,!f){d.next=14;break}return d.prev=3,d.next=6,f(c,u);case 6:p=d.sent,d.next=12;break;case 9:d.prev=9,d.t0=d.catch(3),p=!1;case 12:if(p!==!1){d.next=14;break}return d.abrupt("return",{origin:c,parsedFile:null,action:null,data:null});case 14:if(g=e.props.action,typeof g!="function"){d.next=21;break}return d.next=18,g(c);case 18:v=d.sent,d.next=22;break;case 21:v=g;case 22:if(m=e.props.data,typeof m!="function"){d.next=29;break}return d.next=26,m(c);case 26:S=d.sent,d.next=30;break;case 29:S=m;case 30:return y=(P(p)==="object"||typeof p=="string")&&p?p:c,y instanceof File?k=y:k=new File([y],c.name,{type:c.type}),D=k,D.uid=c.uid,d.abrupt("return",{origin:c,data:S,parsedFile:D,action:v});case 35:case"end":return d.stop()}},l,null,[[3,9]])}));return function(l,c){return i.apply(this,arguments)}}(),e.saveFileInput=function(i){e.fileInput=i},e}return de(n,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(o){var r=this,s=o.data,i=o.origin,l=o.action,c=o.parsedFile;if(this._isMounted){var u=this.props,f=u.onStart,p=u.customRequest,g=u.name,v=u.headers,m=u.withCredentials,S=u.method,y=i.uid,k=p||je,D={action:l,filename:g,data:s,file:c,headers:v,withCredentials:m,method:S||"post",onProgress:function(d){var b=r.props.onProgress;b==null||b(d,c)},onSuccess:function(d,b){var C=r.props.onSuccess;C==null||C(d,c,b),delete r.reqs[y]},onError:function(d,b){var C=r.props.onError;C==null||C(d,b,c),delete r.reqs[y]}};f(i),this.reqs[y]=k(D)}}},{key:"reset",value:function(){this.setState({uid:z()})}},{key:"abort",value:function(o){var r=this.reqs;if(o){var s=o.uid?o.uid:o;r[s]&&r[s].abort&&r[s].abort(),delete r[s]}else Object.keys(r).forEach(function(i){r[i]&&r[i].abort&&r[i].abort(),delete r[i]})}},{key:"render",value:function(){var o,r=this.props,s=r.component,i=r.prefixCls,l=r.className,c=r.disabled,u=r.id,f=r.style,p=r.multiple,g=r.accept,v=r.capture,m=r.children,S=r.directory,y=r.openFileDialogOnClick,k=r.onMouseEnter,D=r.onMouseLeave,E=se(r,Oe),d=ie((o={},T(o,i,!0),T(o,"".concat(i,"-disabled"),c),T(o,l,l),o)),b=S?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},C=c?{}:{onClick:y?this.onClick:function(){},onKeyDown:y?this.onKeyDown:function(){},onMouseEnter:k,onMouseLeave:D,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:"0"};return H.createElement(s,x({},C,{className:d,role:"button",style:f}),H.createElement("input",x({},be(E,{aria:!0,data:!0}),{id:u,disabled:c,type:"file",ref:this.saveFileInput,onClick:function(q){return q.stopPropagation()},key:this.state.uid,style:{display:"none"},accept:g},b,{multiple:p,onChange:this.onChange},v!=null?{capture:v}:{})),m)}}]),n}(h.Component);function X(){}var Ue=function(t){ce(n,t);var a=le(n);function n(){var e;ue(this,n);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=a.call.apply(a,[this].concat(r)),e.uploader=void 0,e.saveUploader=function(i){e.uploader=i},e}return de(n,[{key:"abort",value:function(o){this.uploader.abort(o)}},{key:"render",value:function(){return H.createElement(We,x({},this.props,{ref:this.saveUploader}))}}]),n}(h.Component);Ue.defaultProps={component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:X,onError:X,onSuccess:X,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};export{_e as C,Ue as U,Se as d,De as u};
