import{bZ as y,J as a,I as c,K as N,L as v,aa as h,aO as T,aA as I,T as k,aP as w,bv as g}from"./app-ef1c9cf0.js";import{T as m}from"./index-2304786a.js";import{T as C}from"./TextEllipsis-bba2c97b.js";const b=({fields:t})=>{const{contactTypes:e,isLoading:i}=y(),l=t.contactTypelookupIds?JSON.parse(t.contactTypelookupIds)[0]:"0",s=e==null?void 0:e.find(o=>o.id==l);return a.createElement(a.Fragment,null," ",l&&l!=0?a.createElement(m,{color:s==null?void 0:s.highlight},s==null?void 0:s.name):a.createElement(m,null,"No Type"))},x=({record:t,field:e,handleSubmit:i})=>{const[l]=c.useForm(),[s,o]=a.useState(!1),[p,r]=a.useState(!1),E=N(T,{onSuccess:()=>{v.invalidateQueries("contacts"),i&&i()},onError:n=>{h.error(n.message||"An error occurred")}}),d=async n=>{l.isFieldsTouched(!0)&&await E.mutate({customableId:t.contactId,customableType:"contact",fields:n})},u=()=>{if(e.type=="contactTypeLookup")return a.createElement(b,{fields:t});if(e.type=="tag"&&t[e.fieldName]){const n=JSON.parse(t[e.fieldName+"lookupIds"]);if(Array.isArray(n))return n==null?void 0:n.map(f=>a.createElement(m,null,f))}return e.type=="url"&&t[e.fieldName]?a.createElement("a",{href:t[e.fieldName],target:"_blank"},t[e.fieldName]):e.type=="currency"&&t[e.fieldName]?g(t[e.fieldName]):t[e.fieldName]?t[e.fieldName]:"_"};return a.createElement("div",{style:{width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},!s&&(e.type=="url"&&t[e.fieldName]?a.createElement("div",{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)},p&&a.createElement(I,{className:"p-r-xs",style:{cursor:"pointer"},onClick:()=>o(!0)}),u()):a.createElement("div",{onDoubleClick:()=>{o(!0)},style:{width:"100%",cursor:"pointer"}},a.createElement(k,{title:u()},a.createElement(C,null,u())))),s&&a.createElement("div",{onBlur:()=>{l.submit(),o(!1),r(!1)},style:{overflow:"hidden",textOverflow:"ellipsis",width:"100%"}},a.createElement(c,{form:l,onFinish:d,initialValues:{[e.fieldName]:t[e.fieldName+"lookupIds"]?JSON.parse(t[e.fieldName+"lookupIds"]):t[e.fieldName]},layout:"vertical"},a.createElement(w,{showLabel:!1,customField:e,isSelectOptionsOpen:!0}))))};export{x as C,b as a};
